<div class="analytics">
  <div class="analytics-header">
    <h2><i class="fas fa-chart-pie"></i> Analytiques détaillées</h2>
  </div>

  <!-- Statistiques globales -->
  <div class="stats-row">
    <div class="stat-box">
      <i class="fas fa-coins"></i>
      <div>
        <p class="stat-label">Total dépensé</p>
        <h3>{{ totalExpenses | customCurrency }}</h3>
      </div>
    </div>
    <div class="stat-box">
      <i class="fas fa-calendar-alt"></i>
      <div>
        <p class="stat-label">Moyenne mensuelle</p>
        <h3>{{ averagePerMonth | customCurrency }}</h3>
      </div>
    </div>
    <div class="stat-box" *ngIf="highestCategory">
      <i [class]="getCategoryIcon(highestCategory.category)"></i>
      <div>
        <p class="stat-label">Catégorie principale</p>
        <h3>{{ highestCategory.category }}</h3>
      </div>
    </div>
  </div>

  <!-- Répartition par catégorie -->
  <div class="chart-section">
    <h3><i class="fas fa-percentage"></i> Répartition par catégorie</h3>
    <div class="category-breakdown">
      <div *ngFor="let cat of categoryStats" class="category-row">
        <div class="category-header">
          <i [class]="getCategoryIcon(cat.category)"></i>
          <span class="category-name">{{ cat.category }}</span>
          <span class="category-percentage">{{ getCategoryPercentage(cat.total) | number:'1.1-1' }}%</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" [style.width.%]="getCategoryPercentage(cat.total)"></div>
        </div>
        <div class="category-details">
          <span>{{ cat.total | customCurrency }}</span>
          <span>{{ cat.count }} transaction(s)</span>
        </div>
      </div>
      <div *ngIf="categoryStats.length === 0" class="empty-state">
        <i class="fas fa-chart-pie"></i>
        <p>Aucune donnée disponible</p>
      </div>
    </div>
  </div>

  <!-- Évolution sur 12 mois -->
  <div class="chart-section">
    <h3><i class="fas fa-chart-line"></i> Évolution sur 12 mois</h3>
    <div class="monthly-chart">
      <div *ngFor="let item of monthlyTrend" class="month-bar">
        <div class="bar-wrapper">
          <div class="bar" [style.height.%]="monthlyTrend.length > 0 ? (item.total / monthlyTrend[0].total || 1) * 100 : 0">
            <span class="bar-tooltip">{{ item.total | customCurrency:0 }}</span>
          </div>
        </div>
        <span class="month-label">{{ item.month }}</span>
      </div>
    </div>
  </div>
</div>
