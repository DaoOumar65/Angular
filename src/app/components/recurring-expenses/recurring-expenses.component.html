<div class="recurring-expenses">
  <div class="header">
    <h2><i class="fas fa-sync-alt"></i> Dépenses récurrentes</h2>
    <button class="btn-add" (click)="showAddForm = !showAddForm">
      <i class="fas fa-plus"></i> Nouvelle récurrence
    </button>
  </div>

  <div *ngIf="showAddForm" class="add-form">
    <h3>Ajouter une dépense récurrente</h3>
    <div class="form-grid">
      <input [(ngModel)]="newRecurring.description" placeholder="Description" class="form-input">
      <input type="number" [(ngModel)]="newRecurring.amount" placeholder="Montant" class="form-input">
      <select [(ngModel)]="newRecurring.category" class="form-select">
        <option *ngFor="let cat of categoryService.getCategories()()" [value]="cat">{{ cat }}</option>
      </select>
      <select [(ngModel)]="newRecurring.frequency" class="form-select">
        <option value="daily">Quotidien</option>
        <option value="weekly">Hebdomadaire</option>
        <option value="monthly">Mensuel</option>
        <option value="yearly">Annuel</option>
      </select>
      <input type="date" [(ngModel)]="newRecurring.startDate" class="form-input">
      <input type="date" [(ngModel)]="newRecurring.endDate" placeholder="Date de fin (optionnel)" class="form-input">
    </div>
    <div class="form-actions">
      <button class="btn-save" (click)="addRecurring()">
        <i class="fas fa-check"></i> Enregistrer
      </button>
      <button class="btn-cancel" (click)="resetForm()">
        <i class="fas fa-times"></i> Annuler
      </button>
    </div>
  </div>

  <div class="recurring-list">
    <div *ngFor="let recurring of recurringExpenses" class="recurring-item" [class.inactive]="!recurring.isActive">
      <div class="recurring-info">
        <div class="recurring-header">
          <h4>{{ recurring.description }}</h4>
          <span class="badge" [class]="recurring.frequency">{{ getFrequencyLabel(recurring.frequency) }}</span>
          <span class="badge category">{{ recurring.category }}</span>
        </div>
        <div class="recurring-details">
          <span class="amount">{{ recurring.amount }} €</span>
          <span class="next-due" *ngIf="recurring.nextDue">
            <i class="far fa-calendar"></i> Prochain: {{ recurring.nextDue | date:'dd/MM/yyyy' }}
          </span>
        </div>
      </div>
      <div class="recurring-actions">
        <button class="btn-toggle" (click)="toggleActive(recurring.id)" [title]="recurring.isActive ? 'Désactiver' : 'Activer'">
          <i [class]="recurring.isActive ? 'fas fa-pause' : 'fas fa-play'"></i>
        </button>
        <button class="btn-delete" (click)="deleteRecurring(recurring.id)">
          <i class="fas fa-trash"></i>
        </button>
      </div>
    </div>

    <div *ngIf="recurringExpenses.length === 0" class="empty-state">
      <i class="fas fa-sync-alt"></i>
      <p>Aucune dépense récurrente</p>
    </div>
  </div>
</div>
